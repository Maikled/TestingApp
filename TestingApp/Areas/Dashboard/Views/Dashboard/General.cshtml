@using TestingApp.Areas.Dashboard.Controllers

@model Dashboard

<!doctype html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="~/css/sidebars.css" rel="stylesheet">
        <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/sidebars/">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch/css@3">
        <link href="~/lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    </head>
    <body class="d-flex flex-nowrap">
        <div class="d-flex flex-column flex-shrink-0 p-3 bg-dark" style="width: 280px;">
            <a class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                <span class="fs-4">TestingApp</span>
            </a>
            <hr>
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" aria-current="page" onclick="ShowCreatePartialPage('@Model.CurrentUser?.ID')">
                            Добавить задачу
                        </a>
                    </li>

                    @if(Model.Sources != null)
                    {
                        foreach(var item in Model.Sources)
                        {
                            <li>
                                <a href="#" class="nav-link text-white">
                                    @item.Name
                                </a>
                            </li>
                        }
                    }
                </ul>
            <hr>
            <div class="dropdown">
                <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <strong>@Model.CurrentUser?.Name</strong>
                </a>
                <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
                    <li><a class="dropdown-item" href="#">Профиль</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="/">Выйти</a></li>
                </ul>
            </div>
        </div>
        <div class="d-flex flex-column bg-light" style="width: 100%" id="mainPartialView">
            
        </div>
    </body>
</html>

<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/sidebars.js"></script>

<script>
    async function ShowCreatePartialPage(userID) {
        let data = {
            userID: userID
        };

        let response = await fetch('/Dashboard/GetCreateTaskPartialPage', {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });

        var partialPage = await response.text();

        let divElem = document.getElementById('mainPartialView');
        divElem.innerHTML = partialPage;
    }
</script>